# KylinAutoGUI 😎

结合键盘鼠标模拟与文字识别技术，可提供给用于实现对应用的GUI测试，达到端到端测试的目的。

## 使用方法

|               方法名               |                               描述                           |                                           使用方法                                         |                                           返回值                                       |                                            示例                                         |
| --------------------------------- | ----------------------------------------------------------- | ----------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------- |
|             start_app             |                             启动应用                          |                                      start_app(启动命令)                                   |                          bool类型 (True:启动成功 False:启动失败)                         |                      res = start_app('xdotool exec kylin-scanner')                      |
|             close_app             |                             关闭应用                          |                                      close_app(应用名称)                                   |                          bool类型 (True:关闭成功 False:关闭失败)                         |                            res = close_app('kylin-scanner')                             |
|            restart_app            |                             重启应用                          |                                     restart_app(启动命令)                                  |                          bool类型 (True:重启成功 False:重启失败)                         |                     res = restart_app('xdotool exec kylin-scanner')                     |
|  get_window_id_with_window_name   |                       根据窗口名称获取窗口ID                    |                           get_window_id_with_window_name(窗口名称)                         |                           string类型 (获取成功:窗口ID 获取失败:'')                        |                     res = get_window_id_with_window_name(12345678)                     |
| get_window_id_with_mouse_location |                      获取鼠标当前位置的窗口ID                   |                             get_window_id_with_mouse_location()                           |                                     string类型 窗口ID                                  |                        res = get_window_id_with_mouse_location()                        |
|      get_pid_with_window_id       |                        根据窗口ID获取进程ID                    |                                get_pid_with_window_id(窗口ID)                              |                           string类型 (获取成功:进程ID 获取失败:'')                       |                         res = get_pid_with_window_id('12345678')                        |
|  get_window_name_with_window_id   |                       根据窗口ID获取窗口名称                    |                           get_window_name_with_window_id(窗口ID)                           |                          string类型 (获取成功:窗口名称 获取失败:'')                       |                     res = get_window_name_with_window_id(12345678)                     |
|          get_screen_size          |                          获取屏幕分辨率                        |                                      get_screen_size()                                    |                           list类型 (获取成功:屏幕分辨率[宽度,高度])                       |                                 res = get_screen_size()                                 |
|          get_window_size          |                           获取窗口尺寸                         |                                   get_window_size(窗口ID)                                  |                     list类型 (获取成功:窗口尺寸[宽度,高度] 获取失败:[])                   |                             res = get_window_size(12345678)                             |
|            top_window             |                            置顶窗口                           |                                      top_window(窗口ID)                                    |                          bool类型 (True:置顶成功 False:置顶失败)                        |                               res = top_window(12345678)                               |
|            move_window            |                         将窗口移动到某处                       |                               move_window(窗口ID, 横坐标, 纵坐标)                            |                           bool类型 (True:移动成功 False:移动失败)                       |                          res = move_window(12345678, 100, 200)                          |
|          minimize_window          |                            最小化窗口                         |                                    minimize_window(窗口ID)                                 |                           bool类型 (True:最小化成功 False:最小化失败)                    |                            res = minimize_window(12345678)                             |
|         get_mouse_location        |                        获取当前鼠标位置坐标                     |                                     get_mouse_location()                                  |                           list类型 (鼠标位置坐标[横坐标, 纵坐标])                         |                               res = get_mouse_location()                               |
|             mouse_click           |                          鼠标点击(左键)                        |               mouse_click('left',repeat=1)repeat为重复操作的次数，不输入则默认为1              |                           bool类型 (True:点击成功 False:点击失败)                        |                               res = mouse_click('left')                                |
|             mouse_click           |                          鼠标点击(右键)                        |               mouse_click('right',repeat=1)repeat为重复操作的次数，不输入则默认为1             |                           bool类型 (True:点击成功 False:点击失败)                        |                               res = mouse_click('right')                               |
|             mouse_click           |                          鼠标点击(滚轮)                        |               mouse_click('wheel',repeat=1)repeat为重复操作的次数，不输入则默认为1             |                           bool类型 (True:点击成功 False:点击失败)                        |                               res = mouse_click('wheel')                               |
|             mouse_down            |                          鼠标按下(左键)                        |                                      mouse_down('left')                                   |                           bool类型 (True:按下成功 False:按下失败)                        |                                res = mouse_down('left')                                |
|             mouse_down            |                          鼠标按下(右键)                        |                                      mouse_down('right')                                  |                           bool类型 (True:按下成功 False:按下失败)                        |                                res = mouse_down('right')                               |
|             mouse_down            |                          鼠标按下(滚轮)                        |                                      mouse_down('wheel')                                  |                           bool类型 (True:按下成功 False:按下失败)                        |                                res = mouse_down('wheel')                               |
|              mouse_up             |                          鼠标松开(左键)                        |                                        mouse_up('left')                                   |                           bool类型 (True:松开成功 False:松开失败)                        |                                 res = mouse_up('left')                                 |
|              mouse_up             |                          鼠标松开(右键)                        |                                        mouse_up('right')                                  |                           bool类型 (True:松开成功 False:松开失败)                        |                                 res = mouse_up('right')                                |
|              mouse_up             |                          鼠标松开(滚轮)                        |                                        mouse_up('wheel')                                  |                           bool类型 (True:松开成功 False:松开失败)                        |                                 res = mouse_up('wheel')                                |
|            mouse_scroll           |                          滚轮滚动(向上)                        |                  mouse_scroll('up',repeat=1)repeat为重复操作的次数，不输入则默认为1             |                           bool类型 (True:滚动成功 False:滚动失败)                        |                          res = mouse_scroll('up',repeat=10)                           |
|            mouse_scroll           |                          滚轮滚动(向下)                        |                 mouse_scroll('down',repeat=1)repeat为重复操作的次数，不输入则默认为1            |                           bool类型 (True:滚动成功 False:滚动失败)                        |                         res = mouse_scroll('down',repeat=10)                          |
|         mouse_move_absolute       |                        鼠标移动到绝对位置                       |                           mouse_move_absolute(横坐标, 纵坐标)                               |                           bool类型 (True:移动成功 False:移动失败)                         |                          res = mouse_move_absolute(100, 50)                           |
|         mouse_move_relative       |                        鼠标移动到相对位置                       | mouse_move_relative(横向偏移量, 纵向偏移量)横向偏移量:负值向左，正值向右;纵向偏移量:负值向上，正值向下 |                           bool类型 (True:移动成功 False:移动失败)                        |                          res = mouse_move_relative(-100, 50)                           |
|              key_input            |                          键盘输入某个键                         |                                       key_input(key)                                      |                           bool类型 (True:输入成功 False:输入失败)                        |                                 res = key_input('a')                                  |
|              key_input            |                          键盘输入组合键                         |                                    key_input('键1+键2')                                    |                           bool类型 (True:输入成功 False:输入失败)                        |                               res = key_input('ctrl+a')                               |
|               key_down            |                          按下键盘某个键                         |                                        key_down(key)                                      |                           bool类型 (True:按下成功 False:按下失败)                        |                                  res = key_down('a')                                  |
|               key_up              |                          松开键盘某个键                         |                                         key_up(key)                                       |                           bool类型 (True:松开成功 False:松开失败)                        |                                   res = key_up('a')                                   |
|            input_string           |                          自动输入字符串                         |                                     input_string(字符串)                                   |                           bool类型 (True:输入成功 False:输入失败)                        |                              res = input_string('kylin')                              |
|             screenshot            |                             截取全屏                           |                                         screenshot()                                      |                        string类型 (截图成功:图片的绝对路径 截图失败:'')                    |                                   res = screenshot()                                   |
|             screenshot            |                     截屏并以指定的路径/名称存放                   |                                   screenshot(文件名,文件路径)                                |                       string类型 (截图成功:图片的绝对路径 截图失败:'')                    |              res = screenshot(filename='demo.png',filepath='/home/kylin')              |
|         screenshot_window         |                            截取当前窗口                         |                                      screenshot_window()                                  |                       string类型 (截图成功:图片的绝对路径 截图失败:'')                     |                              res = screenshot_window()                                |
|         screenshot_window         |                 截取当前窗口并以指定的路径和名称存放                |                                screenshot_window(文件名,文件路径)                            |                      string类型 (截图成功:图片的绝对路径 截图失败:'')                     |           res = screenshot_window(filename='demo.png',filepath='/home/kylin')         |
|         screenshot_custom         |                       截取选择的窗口或矩形                       |                     screenshot_custom([起点的横坐标,起点的纵坐标,矩形的宽度,矩形的高度])          |                       string类型 (截图成功:图片的绝对路径 截图失败:'')                    |                       res = screenshot_custom([0, 0, 100, 200])                       |
|         screenshot_custom         |              截取选择的窗口或矩形并以指定的路径和名称存放            |             screenshot_custom([起点的横坐标,起点的纵坐标,矩形的宽度,矩形的高度], 文件名,文件路径)   |                       string类型 (截图成功:图片的绝对路径 截图失败:'')                     | res = screenshot_custom([0, 0, 100, 200],filename='demo.png', filepath='/home/kylin'）|
|        get_all_coordinates        |                      输入图片返回所有文字坐标                     |                                get_all_coordinates(图片绝对路径)                            | dict类型 (识别成功:包含文字及坐标的字典{'文字':{'width':100, 'height':100},...} 识别失败:{} |                     res = get_all_coordinates('/home/kylin/1.png')                     |
|          get_coordinate           | 输入单个字符串返回字典中该字符串的坐标(需在get_all_coordinates后调用) |      get_coordinate(字符串, 坐标字典, 匹配模式)匹配模式:默认为精准匹配，fuzzy=True时为模糊匹配      |   dict类型 (识别成功:包含文字及坐标的字典{'文字':{'width':100, 'height':100}} 识别失败:{}   |                res = get_coordinate('扫描',coordinate_dict,fuzzy=False)                |
|            check_exist            |    检查坐标字典中是否含有指定字符串(需在get_all_coordinates后调用)   |                            check_exist(字符串, 坐标字典, 匹配模式)                            |        string类型 (key:存在，返回字典中与该字符串相匹配的key(文字) '':不存在，返回''          |                 res = check_exist('扫描',coordinate_dict,fuzzy=False)                  |
|        check_exist_by_image       |                    检查图片中是否含有指定文字                     |                      check_exist_by_image(字符串, 图片的绝对路径, 匹配模式)                    |         string类型 (key:存在，返回字典中与该字符串相匹配的key(文字) '':不存在，返回''         |               res = check_exist_by_image('扫描','/home/kylin/1.png',fuzzy=False)       |
|      get_coordinates_by_image     |               输入单个字符串返回图片中该字符串的坐标                |                     get_coordinates_by_image(字符串, 图片的绝对路径, 匹配模式)                 |              dict类型 (存在:返回字典中与该字符串相匹配的坐标字典 不存在:返回{})               |         res = get_coordinates_by_image('扫描','/home/kylin/1.png', fuzzy=False)        |
|          click_location           |                 点击指定窗口的指定位置一次(左键点击)                |                              click_location(窗口ID, 横坐标, 纵坐标)                          |                          bool类型 (True:点击成功 False:点击失败)                        |                        res = click_location(12345678, 100, 100)                       |
|        get_location_click         |              从坐标字典中获得坐标并点击该位置一次(左键点击)          |                         get_location_click(文字, 坐标字典, 窗口ID, 匹配模式)                   |                          bool类型 (True:点击成功 False:点击失败)                        |         res = get_location_click('扫描', coordinate_dict,12345678, fuzzy=True)         |
